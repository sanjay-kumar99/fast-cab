<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Select Your Ride</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <link rel="stylesheet" href="css/style.css" />
    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  </head>

  <body class="bg-gray-100">
    <!-- HEADER -->
    <div
      class="bg-gradient-to-r from-yellow-400 to-orange-500 p-5 text-center shadow-lg"
    >
      <button
        onclick="history.back()"
        class="flex items-center gap-2 bg-white/80 backdrop-blur px-4 py-2 rounded-xl font-semibold shadow-md hover:scale-105 hover:bg-white transition duration-200"
      >
        <span class="text-lg">⬅</span>
        Back
      </button>

      <h1 class="text-2xl font-bold text-dark md:text-3xl tracking-wide">
        Choose Your Perfect Ride
      </h1>
    </div>

    <!-- FILTER -->
    <div class="flex justify-center gap-4 mt-8">
      <button onclick="filterCars('all')" class="filter-btn">All</button>
      <button onclick="filterCars('5')" class="filter-btn">5-Seater</button>
      <button onclick="filterCars('7')" class="filter-btn">7-Seater</button>
    </div>

    <!-- CARS -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-6">
      <!-- Ertiga -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="7"
      >
        <img
          src="images/Ertiga.jpeg"
          alt="Maruti Ertiga"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">
            Maruti Ertiga (7 Seater)
          </h3>
          <p class="text-sm text-gray-600 mt-2">₹17 / km • AC • Spacious</p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(17)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>

      <!-- Swift Dzire -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="5"
      >
        <img
          src="images/Swift.jpeg"
          alt="Swift Dzire"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">
            Swift Dzire (5 Seater)
          </h3>
          <p class="text-sm text-gray-600 mt-2">₹15 / km • AC • Comfortable</p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(15)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>

      <!-- Celerio -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="5"
      >
        <img
          src="images/celerio.jpeg"
          alt="Celerio"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">Celerio (5 Seater)</h3>
          <p class="text-sm text-gray-600 mt-2">
            ₹14 / km • AC •Budget Friendly
          </p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(14)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>

      <!-- Wagonar -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="5"
      >
        <img
          src="images/Wagonar.jpeg"
          alt="Wagonar"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">
            Maruti Wagonar (5 Seater)
          </h3>
          <p class="text-sm text-gray-600 mt-2">
            ₹14 / km • AC • Budget Friendly
          </p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(14)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>

      <!-- Hyundai Aura -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="5"
      >
        <img
          src="images/Hyundai.jpeg"
          alt="Hyundai Aura"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">
            Hyundai Aura (5 Seater)
          </h3>
          <p class="text-sm text-gray-600 mt-2">
            ₹16 / km • AC • Budget Friendly
          </p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(16)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>

      <!-- Kia Carens -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="7"
      >
        <img
          src="images/Kia.jpeg"
          alt="Kia Carens"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">Kia Carens (7 Seater)</h3>
          <p class="text-sm text-gray-600 mt-2">
            ₹20 / km • AC • Budget Friendly
          </p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(20)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>

      <!-- Toyota Rumion -->
      <div
        class="car-card max-w-sm bg-white rounded-2xl shadow-xl overflow-hidden hover:scale-105 transition duration-300"
        data-seat="7"
      >
        <img
          src="images/toyoto.jpeg"
          alt="Toyota Rumion"
          class="w-full h-48 object-cover"
        />
        <div class="p-5">
          <h3 class="text-xl font-bold text-gray-800">
            Toyota Rumion (7 Seater)
          </h3>
          <p class="text-sm text-gray-600 mt-2">
            ₹18 / km • AC • Premium Comfort
          </p>
          <p class="text-xs text-gray-700 font-semibold mt-1">
            * Toll, Interstate & Parking charges extra
          </p>
          <button
            onclick="openBooking(18)"
            class="mt-4 w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold py-2 rounded-lg shadow-md hover:opacity-90 transition"
          >
            BOOK NOW
          </button>
        </div>
      </div>
    </div>

    <!-- BOOKING MODAL -->
    <div
      id="bookingModal"
      class="fixed inset-0 backdrop-blur-sm bg-black/40 hidden flex items-center justify-center"
    >
      <div class="bg-white p-7 rounded-2xl max-w-md shadow-2xl animate-scaleIn">
        <h2 class="text-xl font-bold mb-3">Book Your Ride</h2>

        <input
          id="userName"
          placeholder="Your Name"
          class="w-full border p-2 mb-2"
        />

        <input
          id="userPhone"
          placeholder="Phone Number"
          class="w-full border p-2 mb-2"
        />

        <input
          id="pickup"
          placeholder="Pickup Location"
          class="w-full border p-2 mb-2"
        />

        <input
          id="drop"
          placeholder="Drop Location"
          class="w-full border p-2 mb-2"
        />

        <input
          id="rideDate"
          type="datetime-local"
          class="w-full border p-2 mb-3"
        />
        <!-- Distance & Price -->
        <div class="mb-2">
          <button
            onclick="calculateFare()"
            class="w-full bg-blue-600 text-white py-2 rounded mb-2"
          >
            Calculate Distance & Fare
          </button>

          <input
            id="distance"
            placeholder="Distance (km)"
            class="w-full border p-2 mb-2 bg-gray-100"
            readonly
          />

          <input
            id="fare"
            placeholder="Estimated Fare (₹)"
            class="w-full border p-2 bg-gray-100"
            readonly
          />
        </div>

        <button
          onclick="submitBooking()"
          class="w-full bg-green-600 text-white py-2 rounded"
        >
          Confirm Booking
        </button>

        <button onclick="closeBooking()" class="mt-3 w-full text-red-500">
          Cancel
        </button>
      </div>
    </div>
    <footer class="bg-gray-900 text-gray-300 pt-10 mt-12">
      <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- About -->
        <div>
          <h3 class="text-xl font-bold text-yellow-500 mb-3">Fast Cab</h3>
          <p class="text-sm leading-relaxed">
            Reliable and affordable taxi service available 24/7. Book fast, ride
            safe and reach your destination comfortably.
          </p>

          <div class="flex gap-4 mt-4 text-xl">
            <a href="https://www.facebook.com" target="_blank">
              <i
                class="fa-brands fa-facebook hover:text-yellow-500 cursor-pointer"
              ></i>
            </a>
            <a href="https://www.twitter.com" target="_blank">
              <i
                class="fa-brands fa-twitter hover:text-yellow-500 cursor-pointer"
              ></i>
            </a>
            <a href="https://www.instagram.com" target="_blank">
              <i
                class="fa-brands fa-instagram hover:text-yellow-500 cursor-pointer"
              ></i>
            </a>
            <a href="https://www.whatsapp.com" target="_blank">
              <i
                class="fa-brands fa-whatsapp hover:text-yellow-500 cursor-pointer"
              ></i>
            </a>
          </div>
        </div>

        <!-- Quick Links -->
        <div>
          <h4 class="text-lg font-semibold text-white mb-3">Quick Links</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="index.html" class="hover:text-yellow-500">Home</a></li>
            <li>
              <a href="about.html" class="hover:text-yellow-500">About</a>
            </li>
            <li>
              <a href="services.html" class="hover:text-yellow-500">Services</a>
            </li>
            <li>
              <a href="contact.html" class="hover:text-yellow-500">Contact</a>
            </li>
          </ul>
        </div>

        <!-- Services -->
        <div>
          <h4 class="text-lg font-semibold text-white mb-3">Our Services</h4>
          <ul class="space-y-2 text-sm">
            <li>Local Rides</li>
            <li>Airport Transfers</li>
            <li>Outstation Trips</li>
            <li>Corporate Travel</li>
          </ul>
        </div>

        <!-- Contact -->
        <div>
          <h4 class="text-lg font-semibold text-white mb-3">Contact</h4>

          <p class="text-sm mb-2">
            <i class="fa-solid fa-phone text-yellow-500 mr-2"></i>
            +92 6239662067
          </p>

          <p class="text-sm mb-2">
            <i class="fa-solid fa-envelope text-yellow-500 mr-2"></i>
            cabsservice24@gmail.com
          </p>

          <p class="text-sm">
            <i class="fa-solid fa-location-dot text-yellow-500 mr-2"></i>
            Available 24/7 Service
          </p>
        </div>
      </div>

      <!-- Bottom Bar -->
      <div class="border-t border-gray-700 mt-8 py-4 text-center text-sm">
        © 2026 Fast Cab — All Rights Reserved
      </div>
    </footer>

    <!-- JS -->
    <script>
      let selectedRate = 0;

      // ===== URL BASED AUTO FILTER (From Home Page) =====
      const params = new URLSearchParams(window.location.search);
      const type = params.get("type");

      function filterCars(seat) {
        document.querySelectorAll(".car-card").forEach((card) => {
          card.style.display =
            seat === "all" || card.dataset.seat === seat ? "block" : "none";
        });
      }

      // Auto apply filter when page loads
      window.addEventListener("DOMContentLoaded", () => {
        if (type === "local") filterCars("5");
        else if (type === "airport") filterCars("7");
        else if (type === "outstation") filterCars("all");
      });

      // ===== MODAL FUNCTIONS =====
      function openBooking(rate) {
        selectedRate = rate;
        document.getElementById("bookingModal").classList.remove("hidden");
      }

      function closeBooking() {
        document.getElementById("bookingModal").classList.add("hidden");
      }

      function submitBooking() {
        fetch("https://fast-cab.onrender.com/api/book", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            name: document.getElementById("userName").value,
            phone: document.getElementById("userPhone").value,
            pickup: document.getElementById("pickup").value,
            drop_location: document.getElementById("drop").value,
            ride_datetime: document.getElementById("rideDate").value,
          }),
        })
          .then((res) => res.json())
          .then(() => {
            alert("Booking Successful ✅");
            closeBooking();
          })
          .catch(() => {
            alert("Server Error ❌");
          });
      }
      async function calculateFare() {
        const pickup = document.getElementById("pickup").value;
        const drop = document.getElementById("drop").value;

        if (!pickup || !drop) {
          alert("Enter pickup & drop location");
          return;
        }

        try {
          // Convert location name → coordinates
          const geo1 = await fetch(
            `https://nominatim.openstreetmap.org/search?format=json&q=${pickup}`,
          ).then((r) => r.json());

          const geo2 = await fetch(
            `https://nominatim.openstreetmap.org/search?format=json&q=${drop}`,
          ).then((r) => r.json());

          if (!geo1.length || !geo2.length) {
            alert("Location not found");
            return;
          }

          const start = `${geo1[0].lon},${geo1[0].lat}`;
          const end = `${geo2[0].lon},${geo2[0].lat}`;

          // Route distance
          const route = await fetch(
            `https://router.project-osrm.org/route/v1/driving/${start};${end}?overview=false`,
          ).then((r) => r.json());

          const km = route.routes[0].distance / 1000;
          const fare = km * selectedRate;

          document.getElementById("distance").value = km.toFixed(2);
          document.getElementById("fare").value = Math.round(fare);
        } catch (e) {
          alert("Error calculating distance");
        }
      }
    </script>
  </body>
</html>
